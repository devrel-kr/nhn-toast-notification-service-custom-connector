name: Release to GitHub

on:
  workflow_dispatch:
  push:
    branches:
    - 'feature/*'  
    tags:
    - 'v*'


env:
  function_apps: '["Sms", "Sms.Verification"]'

jobs:
  call_CI_part:
    uses: ./.github/workflows/continuous-integration.yaml
    with:
      action_name: release_github
      function_apps: ${{ env.function_apps }}

    
  call_CD_github:
    needs: 
    - call_CI_part
    uses: ./.github/workflows/continuous-deployment.yaml
    with:
      action_name: release_github
      tag: ${{ github.ref }}
      function_apps: ${{ env.function_apps }}
    secrets:
      GITHUB_TOKEN: ${{ github.token }}    
      